<apps>
  <app name="starcos">

    <formats>

      <format name="EF_GD0">
        <ELEM name="ICCSN" type="tlv" minnum="1" maxnum="1" >
          <tlv id="0x5a">
            <ELEM name="branchKey" type="byte" bcd="1"  />
            <ELEM name="shortBankCode" type="bcd" size="3">
              <DESCR>
                First byte (BCD) shows the group:
                  21: oeffentlich-rechtliche und private banken
                  22: Privat- und Geschaeftsbanken
                  25: Sparkassen
                  26, 29: Genossenschaftsbanken
              </DESCR>
            </ELEM>
            <ELEM name="cardNumber" type="bcd" size="5" />
            <ELEM name="checksum" type="byte" bcd="1" />
          </tlv>
        </ELEM>
      </format>

      <format name="KeyLogDescr">
        <ELEM name="status" type="byte" >
          <DESCR>
            code ! key usable ! descr
            0x10 !    yes     ! key active
            0x0a !    no      ! inactive, use key with cert
            0x08 !    no      ! inactive, about to be overwritten
            0x07 !    no      ! (SK + PK neu beschrieben)
            0x02 !    yes     ! new key created
            0x01 !    yes     ! keynumber or -version missing
            0x00 !    yes     ! INI letter missing to activate
            Unused or deleted descriptors should be set to 
            08-5x-00-00-00-00-00-00
          </DESCR>
        </ELEM>
        <ELEM name="keyType" type="byte" >
          <DESCR>
            Signkey: 53, Cryptkey: 56
          </DESCR>
        </ELEM>
        <ELEM name="keyNum" type="ascii" size="3" lfiller="0x30" />
        <ELEM name="keyVer" type="ascii" size="3" lfiller="0x30" />
        
        <VALUES>
          <VALUE path="status">8</VALUE>
          <VALUE path="keyNum">0</VALUE>
          <VALUE path="keyVer">0</VALUE>
        </VALUES>
        
      </format>

      <format name="EF_KEY_LOG">
        <ELEM name="infoByte" type="byte" >
          <DESCR>
            Bit 7 6 5 4 3 2 1 0 descr
                1               buffer for old DS key: in use
                0               buffer for old DS key: free
                  x x x         max number of entries (1-5)
                        1       buffer for old EN key: in use
                        0       buffer for old EN key: free
                          x x x max number of entries (1-5)
            The maxmimum number of accounts can be derived from this:
            (max number of entries-2)/4
          </DESCR>
        </ELEM>
        <format type="KeyLogDescr" minnum="0" maxnum="0" />
      </format>

      <format name="IpfKey">
        <ELEM name="kid" type="byte" />
        <ELEM name="recordLen1" type="word" />
        <ELEM name="siAndCert" type="bytes" size="3">9a0f80</ELEM>
        <ELEM name="algoByte"  type="byte" >
          <DESCR>
            Bit 7 6 5 4 3 2 1 0 descr
                x x x x   x     RFU
                        1       modulus is in LSB first format (Intel)
                        0       modulus is in MSB first format
                            1 - DSA allowed
                            - 1 RSA allowed
            Mostly used:
            01: modulus is in MSB first format (big endian, 68000er)
            09: modulus is in LSB first format (little endian, Intel)
            The card stores the modulus in LSB first format so you might
            as well deliver it in that format.
          </DESCR>
        </ELEM>
        <ELEM name="akdByte" type="byte" >
          <DESCR>
            Bit 7 6 5 4 3 2 1 0 descr
                x x x           RFU
                      1         Compute signature allowed
                        1       Verify signature allowed
                          1     Read public key allowed
                            1   Decipher/encipher allowed
                              1 In/External authenticate allowed
            Mostly used:
            08: sign key
            02: crypt key
          </DESCR>
        </ELEM>
        <ELEM name="recordLen2" type="word" />
        <!-- Key Format List -->
        <ELEM name="kfl1" type="bytes" size="4">08010110</ELEM>
        <ELEM name="modLen" type="byte" />
        <ELEM name="kfl2" type="bytes" size="3">130300</ELEM>
        <ELEM name="emptyLen" type="byte">
          <DESCR>This is (0x60-modLen)</DESCR>
        </ELEM>
        <!-- Key -->
        <ELEM name="chid" type="byte" >
          <DESCR>This is the same as in kid</DESCR>
        </ELEM>
        <ELEM name="modAndExpo" type="bytes" size="101" filler="0x00" >
          <DESCR>
            The first modLen bytes belong to the modulus, followed by the 
            three byte exponent. The rest is empty space.
          </DESCR>
        </ELEM>
        
        <values>
          <value path="recordLen1">0x006d</value>
          <value path="recordLen2">0x806d</value>
        </values>
        
      </format>

      <format name="ipf" >
        <ELEM name="keyCount" type="byte" />
        <FORMAT type="IpfKey" minnum="0" maxnum="0" />
      </format>

    </formats>



    <files>
      <ef name="EF_GD0" sid="0x2f02" 
          type="transparent"
          size="12" >
        <DESCR>
          This file contains the ICCSN according to ISO-7812-1
        </DESCR>
        <FORMAT type="EF_GD0" />
      </ef>
  
      <df name="DF_BANKING" lid="d27600007448420110">
        <files>
          <ef name="EF_IPF" sid="0xb300"
              type="transparent" >
            <DESCR>
              This file contains the public keys of the cardholder and the
              banks.
            </DESCR>
            <FORMAT type="ipf" />
          </ef>
          
          <ef name="EF_SEQ" sid="0xa601" 
              type="record" mode="linear" 
              size="4" minnum="1" >
            <DESCR>
              This file contains the signature counters for every account.
            </DESCR>
            <record>
              <ELEM name="seq" type="dword" />
            </record>
          </ef>
          
          <ef name="EF_BNK" sid="0xa603"
              type="record" mode="linear" 
              size="154" minnum="1" >
            <record>
              <ELEM name="country" type="ascii"
                    size="3" filler="32" condense="1" />
              <ELEM name="bankCode" type="ascii"   
                    size="30" filler="32" condense="1" />
              <ELEM name="userId" type="ascii"      
                    size="30" filler="32" condense="1" trust="3" />
              <ELEM name="comService" type="byte" bcd="1" />
              <ELEM name="comAddress" type="ascii"  
                    size="28" filler="32" condense="1" />
              <ELEM name="comSuffix" type="ascii"   
                    size="2" filler="32" condense="1" />
              <ELEM name="bankId" type="ascii"      
                    size="30" filler="32" condense="1" trust="3" />
              <ELEM name="systemId" type="ascii"      
                    size="30" filler="32" condense="1" trust="3" />
            </record>
          </ef>
  
          <ef name="EF_KEY_LOG" sid="0xa602"
              type="transparent">
          </ef>
          
        </files>  
      </df>
      
    </files>
  </app>
</apps>


