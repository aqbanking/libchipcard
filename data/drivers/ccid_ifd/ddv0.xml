<cards>
  <card name="ddv0" >

    <commands>


      <!-- Verify PIN -->
      <command name="VerifyPin" driver="ccid_ifd">
        <send>
	  			<APDU >
  	    		<ELEM type="dword">0x00200081</ELEM>
	  			</APDU>
	  			<DATA>
	    			<ELEM name="pin" type="fpin2" minsize="4" maxsize="8" />
	  			</DATA>
				</send>
				<results>
      		<result sw1="0x63" sw2="0xc0" type="error" >
            Bad PIN (only one try left !)
          </result>
      		<result sw1="0x63" type="error" >Bad PIN</result>
      		<result sw1="0x63" sw2="0xc1" type="error" >
            Bad PIN (only two tries left !)
          </result>
      		<result sw1="0x63" sw2="0xc2" type="error" >
            Bad PIN (only three tries left !)
          </result>
      		<result sw1="0x69" sw2="0x83" type="error" >
            Card seems to be destroyed, this might have the following reasons:
             1) you entered a bad PIN too often
             2) the card is of a new and yet unknown type
          </result>
				</results>
      </command>

      <!-- Secure PIN verification using the reader's keypad -->
      <command name="SecureVerifyPin" target="reader" driver="ccid_ifd">
        <send>
	  			<APDU>
            <ELEM type="dword" bigEndian="0" >0x31202c</ELEM>
            <ELEM type="byte">0x8b</ELEM>
  	    		<ELEM type="dword">0x20180100</ELEM>
	  			</APDU>
	  			<DATA>
	    			<ELEM type="bytes" storedAs="bytes" >
              52 0f 02 06 00 20 00 81 08 25 ff ff ff ff ff ff ff
            </ELEM>
          </DATA>
				</send>
				<results>
      		<result sw1="0x90" type="success" >
            PIN ok
          </result>
      		<result sw1="0x63" sw2="0xc0" type="error" >
            Bad PIN (only one try left !)
          </result>
      		<result sw1="0x63" type="error" >Bad PIN</result>
      		<result sw1="0x63" sw2="0xc1" type="error" >
            Bad PIN (only two tries left !)
          </result>
      		<result sw1="0x63" sw2="0xc2" type="error" >
            Bad PIN (only three tries left !)
          </result>
      		<result sw1="0x69" sw2="0x83" type="error" >
            Card seems to be destroyed, this might have the following reasons:
             1) you entered a bad PIN too often
             2) the card is of a new and yet unknown type
          </result>
      		<result sw1="0x64" sw2="0x00" type="error" >
            Verification aborted due to timeout
          </result>
      		<result sw1="0x64" sw2="0x01" type="error" >
            Verification aborted by user
          </result>
				</results>
      </command>

      <!-- Get 8 byte random number -->
      <command name="GetChallenge" driver="ccid_ifd">
        <send>
	  			<APDU lr="0" >
  	    		<ELEM type="dword">0x00840000</ELEM>
	  			</APDU>
				</send>
				<responses>
	  			<response type="success">
	    			<ELEM name="challenge" type="bytes" minsize="8" maxsize="8" />
          </response>
        </responses>
      </command>

      <!-- Let card authenticate itself (used for encryption) -->
      <command name="CryptBlock" driver="ccid_ifd">
        <send>
	  			<APDU lr="0" >
  	    		<ELEM type="dword">0x00880080</ELEM>
	  			</APDU>
	  			<DATA>
	    			<ELEM name="in" type="bytes" minsize="8" maxsize="8" />
          </DATA>
				</send>
				<responses>
	  			<response type="success">
	    			<ELEM name="out" type="bytes" minsize="8" maxsize="8" />
          </response>
        </responses>
      </command>

      <!-- Writes the right 12 bytes of a hash to the file EF_MAC -->
      <command name="WriteHashR" driver="ccid_ifd">
        <send>
	  			<APDU>
  	    		<ELEM type="dword">0x00dc01dc</ELEM>
	  			</APDU>
	  			<DATA>
	    			<ELEM name="hashR" type="bytes" size="12" />
          </DATA>
				</send>
				<results>
      		<result sw1="0x69" sw2="0x82" type="error" >
            You must verify then PIN before using this command
          </result>
				</results>
      </command>

      <!-- Writes the left 8 bytes of a hash to the file EF_MAC -->
      <command name="WriteHashL" driver="ccid_ifd">
        <send>
	  			<APDU>
  	    		<ELEM type="dword">0x00da0100</ELEM>
	  			</APDU>
	  			<DATA>
	    			<ELEM name="hashL" type="bytes" size="8" />
          </DATA>
				</send>
				<results>
      		<result sw1="0x69" sw2="0x82" type="error" >
            You must verify then PIN before using this command
          </result>
				</results>
      </command>

      <!-- Read signed hash -->
      <command name="ReadSignedHash" driver="ccid_ifd">
        <send>
	  			<APDU lr="20" >
  	    		<ELEM type="dword">0x04b201dc</ELEM>
	  			</APDU>
				</send>
				<results>
      		<result sw1="0x69" sw2="0x82" type="error" >
            You must verify then PIN before using this command
          </result>
				</results>
				<responses>
	  			<response type="success">
            <ELEM name="trash" type="bytes" size="12" />
	    			<ELEM name="signedHash" type="bytes" size="8" />
          </response>
        </responses>
      </command>

      <!-- Select Master File -->
      <command name="SelectMF" driver="ccid_ifd">
      	<send>
	  			<APDU >
  	    		<ELEM type="dword">0x00a4000c</ELEM>
	  			</APDU>
				</send>
				<results>
      		<result sw1="0x6a" sw2="0x82" type="error">File not found</result>
				</results>
				<responses>
	  			<response type="success">
	    	 		<ELEM name="fileInfo" type="tlv" tlvtype="simple" minnum="0">
              <tlv id="0x6f">
                <ELEM name="fci" type="tlv" tlvtype="simple"
                      maxnum="0">
                  <tlv id="0x81">
                    <ELEM name="space" type="word" />
                  </tlv>
                  <tlv id="0x82">
                    <ELEM name="fileDescr" type="bytes" />
                  </tlv>
                  <tlv id="0x83">
                    <ELEM name="shortFileId" type="word" />
                  </tlv>
                  <tlv id="0x84">
                    <ELEM name="fileName" type="bytes" />
                  </tlv>
                  <tlv id="0x85">
                    <ELEM name="sfi" type="byte" />
                    <ELEM name="filePath" type="bytes" />
                  </tlv>
                  <tlv id="0x86" name="AC" >
                    <ELEM name="AC_admin" type="word" />
                    <GROUP name="AC_cmd" minnum="0" maxnum="0" >
                      <ELEM name="cla" type="byte" />
                      <ELEM name="ins" type="byte" />
                      <ELEM name="ac" type="word" />
                    </GROUP>
                  </tlv>
                  <tlv id="0xa5">
                    <ELEM name="accessControl" type="tlv" tlvtype="simple"
                          maxnum="0">
                      <tlv id="0x86" name="AC" >
                        <ELEM name="sfi" type="byte" />
                        <ELEM name="AC_admin" type="word" />
                        <ELEM name="moreACs" type="bytes" minnum="0" />
                      </tlv>
                    </ELEM>
                  </tlv>
                </ELEM>
              </tlv>
            </ELEM>
	  			</response>
				</responses>
    	</command>


    </commands>

    
    <!-- generic command responses -->
    <results>
    </results>

  </card>
</cards>

