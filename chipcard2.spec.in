%define name chipcard2
%define version @VERSION@
%define release @rpm_release@
%define rpm_cxxflags \"-O2 -march=i486 -mcpu=i586\"
%define rpm_cflags \"-O2 -march=i486 -mcpu=i586\"


# Note: All commands below use %{_prefix}, which is rpm's system
# default prefix (as defined in /usr/lib/rpm/macros), so this variable
# is not used inside this spec file.
#%define prefix @prefix@

Summary: A library for easy access to smart cards (chipcards).
Name: %{name}
Version: %{version}
Release: %{release}
Source: http://download.sourceforge.net/libchipcard/%{name}-%{version}.tar.gz
Requires: gwenhywfar
Group: Libraries/System
Copyright: GPL
Packager: Martin Preuss <martin@libchipcard.de>
URL: http://www.libchipcard.de
BuildRoot: %{_tmppath}/%{name}-%{version}-root
Prereq: /sbin/ldconfig
Prefix: %{_prefix}

%description
Libchipcard allows easy access to smart cards. It provides basic access
to memory and processor cards and has special support for German medical
cards, German "Geldkarten" and HBCI (homebanking) cards (both type 0 and 
type 1).
It accesses the readers via CTAPI or PC/SC interfaces and has successfully
been tested with Towitoko, Kobil and Reiner-SCT readers.
This package contains the chipcard2-daemon needed to access card readers.

%package devel
Summary: LibChipCard server development kit
Group: Development/Libraries
%description devel
This package contains chipcard2-server-config and header files for writing 
drivers, services or even your own chipcard daemon for LibChipCard.


%prep
%setup -q

%build
CXXFLAGS=%{rpm_cxxflags} CFLAGS=%{rpm_cflags}  \
  ./configure --prefix=%{_prefix} \
              --libdir=%{_libdir} --datadir=%{_datadir} \
              --includedir=%{_includedir}

make

%install
[ "$RPM_BUILD_ROOT" != "/" ] && rm -rf $RPM_BUILD_ROOT
LIBRARY_PATH=$RPM_BUILD_ROOT%{_libdir} make DESTDIR=$RPM_BUILD_ROOT \
  install

%clean
[ "$RPM_BUILD_ROOT" != "/" ] && rm -rf $RPM_BUILD_ROOT

%post
/sbin/ldconfig

%postun
/sbin/ldconfig

%files
%defattr(-,root,root,0755)
%doc README COPYING ChangeLog
%{_libdir}/*.so
%{_libdir}/*.so.*

%files devel
%defattr(-,root,root,0755)
%doc README COPYING ChangeLog
%{_bindir}/chipcard2-server-config
%{_includedir}/*
%{_libdir}/*.a
%{_libdir}/*.la
%{_datadir}/aclocal/chipcard2-server.m4


%changelog

